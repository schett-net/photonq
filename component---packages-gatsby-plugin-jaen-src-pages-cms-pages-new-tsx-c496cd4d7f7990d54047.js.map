{"version":3,"file":"component---packages-gatsby-plugin-jaen-src-pages-cms-pages-new-tsx-c496cd4d7f7990d54047.js","mappings":"2RAYO,MAAMA,EAA0BC,IAEnCC,EAAAA,EAAAA,IAACC,EAAAA,EAAI,CAACC,GAAG,OAAMC,UACbH,EAAAA,EAAAA,IAACI,EAAAA,EAAe,IAAKL,EAAMM,S,aCJjC,MAAMC,EAAqBA,KACzB,MAAM,MAACC,IAASC,EAAAA,EAAAA,MACVC,GAAUC,EAAAA,EAAAA,MAEVC,GAAcC,EAAAA,EAAAA,UAAQ,KAC1B,MAAMC,EAAQJ,EAAQI,QAEhBC,EASF,CAAC,EAEL,IAAK,MAAMC,KAAQF,EAAO,CACxB,MAAMG,EAAgBP,EAAQQ,iBAAiBF,EAAKb,IAEhDc,EAAcE,OAAS,IACzBJ,EAAaC,EAAKb,IAAM,CACtBiB,MAAOJ,EAAKK,iBAAiBC,OAASN,EAAKO,KAC3CC,UAAWP,EAAcQ,QAAO,CAACC,EAAKC,KACpCD,EAAIC,EAASxB,IAAM,CACjBiB,MAAOO,EAASP,OAGXM,IACN,CAAC,IAGV,CAEA,OAAOX,CAAY,GAClB,IAEGa,GAAWC,EAAAA,EAAAA,gBAEX,EAACC,EAAmB,EAAEC,IAA0BC,EAAAA,EAAAA,eAEpDC,GAgBF,OAdAC,EAAAA,EAAAA,YAAU,KACR,IACE,MAAMC,EAASC,KAAKR,EAASS,KAAKC,QAAQ,IAAK,KAE/CC,OAAOC,SAAS,EAAG,GAEf5B,EAAYuB,IACdJ,EAAuBI,EAE3B,CAAE,MAAOM,GACPC,QAAQC,MAAMF,EAChB,IACC,CAACb,EAASS,KAAMzB,KAGjBX,EAAAA,EAAAA,IAACF,EAAG,CACFO,KAAM,CACJsC,OAAQ,CACNC,WAAYf,GAEdlB,cACAkC,SAAUC,IAAQ,IAAAC,EAChB,MAAMC,EAAcvC,EAAQwC,QAAQ,CAClC3B,KAAMwB,EAAKxB,KACXI,SAAUoB,EAAKpB,SACfkB,WAAY,CACV1C,GAAI4C,EAAKF,YAEXM,kBAAmBJ,EAAKK,oBACxB/B,iBAAkB,CAChBC,MAAOyB,EAAKzB,MACZ+B,MAAiB,QAAZL,EAAED,EAAKM,aAAK,IAAAL,OAAA,EAAVA,EAAYM,IACnBC,YAAaR,EAAKQ,YAClBC,SAAUT,EAAKS,YAInBhD,EAAM,CACJc,MAAO,eACPiC,YAAa,QAAQR,EAAKzB,MAAK,oBAC/BmC,OAAQ,aAGVC,EAAAA,EAAAA,IAAS,eAAeC,KAAKV,GAAe,IAGhD,EAYN,MARkCW,KAE9B3D,EAAAA,EAAAA,IAAC4D,EAAAA,GAAa,CAAAzD,UACZH,EAAAA,EAAAA,IAACM,EAAQ,MAOR,MAAMuD,EAAyB,CACpC1C,MAAO,WACP2C,YAAa,CACX,CACE3C,MAAO,MACP4C,KAAM,SAER,CACE5C,MAAO,QACP4C,KAAM,eAER,CACE5C,MAAO,MACP4C,KAAM,oBAGVC,8BAA8B,EAC9BC,KAAM,CACJC,iBAAiB,GAEnBC,OAAQ,CACNC,KAAM,OACNC,KAAM,Q","sources":["webpack://photonq/../packages/gatsby-plugin-jaen/src/components/cms/Pages/New/New.tsx","webpack://photonq/../packages/gatsby-plugin-jaen/src/pages/cms/pages/new.tsx"],"sourcesContent":["import {Flex} from '@chakra-ui/react'\nimport React from 'react'\n\nimport {\n  PageContentForm,\n  PageContentFormProps\n} from '../shared/PageContentForm/PageContentForm'\n\nexport interface NewProps {\n  form: PageContentFormProps\n}\n\nexport const New: React.FC<NewProps> = props => {\n  return (\n    <Flex id=\"coco\">\n      <PageContentForm {...props.form} />\n    </Flex>\n  )\n}\n","import {useLocation} from '@reach/router'\nimport {PageConfig, useNotificationsContext} from 'jaen'\nimport {navigate, PageProps} from 'gatsby'\nimport {useEffect, useMemo, useState} from 'react'\n\nimport {New} from '../../../components/cms/Pages/New'\nimport {\n  CMSManagement,\n  useCMSManagement\n} from '../../../connectors/cms-management'\n\nconst PagesNew: React.FC = () => {\n  const {toast} = useNotificationsContext()\n  const manager = useCMSManagement()\n\n  const parentPages = useMemo(() => {\n    const pages = manager.pages()\n\n    const _parentPages: {\n      [pageId: string]: {\n        label: string\n        templates: {\n          [templateId: string]: {\n            label: string\n          }\n        }\n      }\n    } = {}\n\n    for (const page of pages) {\n      const pageTemplates = manager.templatesForPage(page.id)\n\n      if (pageTemplates.length > 0) {\n        _parentPages[page.id] = {\n          label: page.jaenPageMetadata.title || page.slug,\n          templates: pageTemplates.reduce((acc, template) => {\n            acc[template.id] = {\n              label: template.label\n            }\n\n            return acc\n          }, {} as {[key: string]: {label: string}})\n        }\n      }\n    }\n\n    return _parentPages\n  }, [])\n\n  const location = useLocation()\n\n  const [defaultParentPageId, setDefaultParentPageId] = useState<\n    string | undefined\n  >(undefined)\n\n  useEffect(() => {\n    try {\n      const pageId = atob(location.hash.replace('#', ''))\n\n      window.scrollTo(0, 0)\n\n      if (parentPages[pageId]) {\n        setDefaultParentPageId(pageId)\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, [location.hash, parentPages])\n\n  return (\n    <New\n      form={{\n        values: {\n          parentPage: defaultParentPageId\n        },\n        parentPages,\n        onSubmit: data => {\n          const addedPageId = manager.addPage({\n            slug: data.slug,\n            template: data.template,\n            parentPage: {\n              id: data.parentPage\n            },\n            excludedFromIndex: data.isExcludedFromIndex,\n            jaenPageMetadata: {\n              title: data.title,\n              image: data.image?.src,\n              description: data.description,\n              blogPost: data.blogPost\n            }\n          })\n\n          toast({\n            title: 'Page created',\n            description: `Page ${data.title} has been created`,\n            status: 'success'\n          })\n\n          navigate(`/cms/pages/#${btoa(addedPageId)}`)\n        }\n      }}\n    />\n  )\n}\n\nconst Page: React.FC<PageProps> = () => {\n  return (\n    <CMSManagement>\n      <PagesNew />\n    </CMSManagement>\n  )\n}\n\nexport default Page\n\nexport const pageConfig: PageConfig = {\n  label: 'New page',\n  breadcrumbs: [\n    {\n      label: 'CMS',\n      path: '/cms/'\n    },\n    {\n      label: 'Pages',\n      path: '/cms/pages/'\n    },\n    {\n      label: 'New',\n      path: '/cms/pages/new/'\n    }\n  ],\n  withoutJaenFrameStickyHeader: true,\n  auth: {\n    isAdminRequired: true\n  },\n  layout: {\n    name: 'jaen',\n    type: 'form'\n  }\n}\n\nexport {Head} from 'jaen'\n"],"names":["New","props","_jsx","Flex","id","children","PageContentForm","form","PagesNew","toast","useNotificationsContext","manager","useCMSManagement","parentPages","useMemo","pages","_parentPages","page","pageTemplates","templatesForPage","length","label","jaenPageMetadata","title","slug","templates","reduce","acc","template","location","useLocation","defaultParentPageId","setDefaultParentPageId","useState","undefined","useEffect","pageId","atob","hash","replace","window","scrollTo","e","console","error","values","parentPage","onSubmit","data","_data$image","addedPageId","addPage","excludedFromIndex","isExcludedFromIndex","image","src","description","blogPost","status","navigate","btoa","Page","CMSManagement","pageConfig","breadcrumbs","path","withoutJaenFrameStickyHeader","auth","isAdminRequired","layout","name","type"],"sourceRoot":""}
"use strict";(self.webpackChunkphotonq=self.webpackChunkphotonq||[]).push([[343],{1895:function(e,t,i){i.d(t,{N:function(){return o}});var r=i(2955),a=i(8034),n=i(2605),s=i(7800);const o=e=>{const{title:t,children:i,...o}=e;return(0,s.BX)(r.K,{direction:{base:"column",md:"row"},spacing:"6",py:"4",...o,children:[(0,s.tZ)(a.xu,{minW:"3xs",children:t&&(0,s.tZ)(n.X,{as:"h2",fontWeight:"semibold",fontSize:"lg",flexShrink:0,children:t})}),i]})}},7272:function(e,t,i){i.d(t,{r:function(){return r.r}});var r=i(2388)},7037:function(e,t,i){i.r(t),i.d(t,{Head:function(){return r.Fb},default:function(){return k},pageConfig:function(){return _}});var r=i(4482),a=i(2955),n=i(7704),s=i(2605),o=i(6453),l=i(5987),d=i(948),c=i(9002),u=i(3100),m=i(5699),h=i(7378),f=i(8039),p=i(1895),g=i(8034),v=i(4303),Z=i(5113),y=i(957),b=i(4416),w=i(3778),S=i(7228),x=i(9707),N=i(7800);const R=e=>{const{0:t,1:i}=(0,h.useState)(!1),{0:r,1:n}=(0,h.useState)(null),s=(0,h.useCallback)((t=>{t.length>0&&(i(!0),setTimeout((()=>{i(!1),n(t[0]),e.onChoose(t[0])}),1e3))}),[e]),{getRootProps:o,getInputProps:l,open:d}=(0,x.uI)({accept:{"image/*":[".jpg",".jpeg",".png",".gif"]},onDrop:s,multiple:!1});return(0,N.BX)(a.K,{direction:"row",spacing:"6",align:"center",width:"full",children:[(0,N.BX)(g.xu,{boxSize:36,minW:"36",borderRadius:"lg",bg:"bg.subtle",...o(),children:[r||e.value?(0,N.tZ)(v.E,{borderRadius:"lg",boxSize:"100%",src:r?URL.createObjectURL(r):e.value,fallback:(0,N.tZ)(Z.O,{borderRadius:"lg",boxSize:"100%"})}):(0,N.tZ)(y.M,{boxSize:"100%",borderRadius:"lg",children:(0,N.tZ)(b.x,{color:"muted",fontSize:"sm",children:"No image"})}),(0,N.tZ)("input",{...l()})]}),(0,N.BX)(a.K,{children:[(0,N.BX)(w.U,{spacing:"5",children:[(0,N.tZ)(m.z,{isLoading:t,variant:"outline",leftIcon:(0,N.tZ)(S.FaCloudUploadAlt,{}),onClick:d,children:"Choose media"}),r&&(0,N.tZ)(m.z,{variant:"ghost",onClick:()=>{n(null),e.onRemove()},children:"Remove"})]}),(0,N.tZ)(b.x,{fontSize:"sm",mt:"3",color:"muted",children:e.description})]})]})},C=e=>{let{onSubmit:t,defaultValues:i}=e;const{handleSubmit:r,register:n,control:s,formState:{errors:g,isSubmitting:v},setValue:Z,reset:y}=(0,f.cI)({defaultValues:i}),[b,w]=h.useState(null),S=r((async e=>{await t({...e,avatarFile:b}),y(e)}));return(0,N.tZ)("form",{onSubmit:S,children:(0,N.tZ)(p.N,{title:"Account",children:(0,N.BX)(a.K,{width:"full",spacing:"8",maxW:"2xl",children:[(0,N.BX)(a.K,{children:[(0,N.BX)(o.NI,{id:"firstName",isInvalid:!!g.firstName,children:[(0,N.tZ)(l.l,{children:"First Name"}),(0,N.tZ)(d.I,{placeholder:"",...n("firstName",{})}),(0,N.tZ)(c.J1,{children:g.firstName&&g.firstName.message})]}),(0,N.BX)(o.NI,{id:"lastName",isInvalid:!(null==g||!g.lastName),children:[(0,N.tZ)(l.l,{children:"Last Name"}),(0,N.tZ)(d.I,{placeholder:"",...n("lastName",{})}),(0,N.tZ)(c.J1,{children:g.lastName&&g.lastName.message})]})]}),(0,N.BX)(o.NI,{id:"username",isInvalid:!!g.username,isDisabled:!0,children:[(0,N.tZ)(l.l,{children:"Username"}),(0,N.tZ)(d.I,{isDisabled:!0,maxW:"xs",...n("username",{required:"This field is required"}),autoComplete:"false",color:"fg.muted"}),(0,N.tZ)(c.J1,{children:g.username&&g.username.message})]}),(0,N.BX)(o.NI,{id:"image",children:[(0,N.tZ)(l.l,{children:"Image"}),(0,N.tZ)(f.Qr,{control:s,name:"avatarURL",render:e=>{let{field:{value:t}}=e;return(0,N.tZ)(R,{value:t,onChoose:e=>{w(e),Z("avatarURL",URL.createObjectURL(e),{shouldDirty:!0})},onRemove:()=>{w(null),Z("avatarURL",(null==i?void 0:i.avatarURL)||"")},description:"Upload a profile picture to make your account easier to recognize."})}})]}),(0,N.tZ)(u.h,{children:(0,N.tZ)(m.z,{isLoading:v,type:"submit",variant:"outline",children:"Update account"})})]})})})};var I=i(3330),X=i(5524),P=i(1644),B=i(8671),L=i(7272);const U=e=>{let{onSubmit:t,onRemove:i,onResendVerification:r,defaultValues:s}=e;const{handleSubmit:o,register:l,control:c,formState:{errors:h,isSubmitting:g},setValue:v,reset:Z}=(0,f.cI)(),y=o((async e=>{await t(e),Z()}));return(0,N.tZ)(p.N,{title:"Emails",children:(0,N.BX)(a.K,{spacing:"6",children:[(0,N.tZ)(I.Z,{maxW:"full",children:(0,N.tZ)(X.e,{children:(0,N.tZ)(a.K,{divider:(0,N.tZ)(n.c,{}),spacing:"4",children:null==s?void 0:s.emails.sort(((e,t)=>Number(t.isPrimary)-Number(e.isPrimary))).map((e=>(0,N.BX)(a.K,{children:[(0,N.BX)(w.U,{justify:"space-between",children:[(0,N.BX)(w.U,{children:[(0,N.tZ)(b.x,{fontSize:"sm",fontWeight:"bold",children:e.emailAddress}),"-"," ",(0,N.tZ)(b.x,{children:e.isPrimary&&(0,N.BX)(N.HY,{children:["-","  ",(0,N.tZ)(b.x,{fontSize:"sm",as:"span",color:"green.500",children:"Primary"})]})})]}),(0,N.tZ)(P.h,{size:"xs","aria-label":"Delete email address",variant:"ghost",color:"red.500",visibility:e.isPrimary?"hidden":"visible",icon:(0,N.tZ)(S.FaTrash,{}),onClick:()=>i(e.id)})]}),(0,N.BX)(B.QI,{children:[e.isPrimary&&(0,N.tZ)(B.HC,{fontSize:"sm",color:"muted",children:"Primary email addresses are used for account-related communications (e.g. password resets)."}),!e.isVerified&&(0,N.tZ)(B.HC,{fontSize:"sm",color:"muted",children:(0,N.BX)(w.U,{children:[(0,N.tZ)(b.x,{children:"Unverified"}),(0,N.tZ)(L.r,{onClick:()=>{r(e.id)},children:"Resend verification email"})]})})]})]},e.id)))})})}),(0,N.BX)(a.K,{spacing:"4",children:[(0,N.tZ)(b.x,{fontSize:"sm",color:"muted",children:"Add an email address to your account."}),(0,N.tZ)("form",{onSubmit:y,children:(0,N.BX)(a.K,{direction:"row",spacing:"4",children:[(0,N.tZ)(d.I,{maxW:"xs",...l("emailAddress",{required:"This field is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",placeholder:"Email"}),(0,N.tZ)(u.h,{children:(0,N.tZ)(m.z,{type:"submit",isLoading:g,loadingText:"Adding...",variant:"outline",children:"Add"})})]})})]})]})})},z=e=>{let{onSubmit:t,passwordResetPath:i}=e;const{handleSubmit:r,control:n,formState:{isSubmitting:s,errors:u},watch:h}=(0,f.cI)(),g=r((async e=>{await t(e)})),v=h("password","");return(0,N.tZ)("form",{onSubmit:g,children:(0,N.tZ)(p.N,{title:"Password",children:(0,N.BX)(a.K,{width:"full",spacing:"6",maxW:"2xl",children:[(0,N.tZ)(d.I,{type:"email",name:"email",autoComplete:"email",display:"none"}),(0,N.BX)(o.NI,{id:"password",children:[(0,N.tZ)(l.l,{children:"Password"}),(0,N.tZ)(f.Qr,{control:n,name:"password",rules:{required:"This field is required"},render:e=>{let{field:t}=e;return(0,N.tZ)(d.I,{maxW:"xs",...t,type:"password",autoComplete:"new-password"})}})]}),(0,N.BX)(o.NI,{id:"confirmPassword",isInvalid:!!u.confirmPassword,children:[(0,N.tZ)(l.l,{children:"Confirm Password"}),(0,N.tZ)(f.Qr,{control:n,name:"confirmPassword",rules:{required:"This field is required",validate:e=>e===v||"Passwords do not match"},render:e=>{let{field:t}=e;return(0,N.tZ)(d.I,{maxW:"xs",...t,type:"password",autoComplete:"new-password"})}}),(0,N.tZ)(c.J1,{children:u.confirmPassword&&u.confirmPassword.message})]}),(0,N.BX)(a.K,{children:[(0,N.tZ)(b.x,{fontSize:"sm",color:"muted",children:"Make sure your password is at least 15 characters OR at least 8 characters including a number and a lowercase letter."}),(0,N.BX)(w.U,{spacing:"4",children:[(0,N.tZ)(m.z,{isLoading:s,type:"submit",variant:"outline",children:"Update password"}),(0,N.tZ)(L.r,{fontSize:"sm",to:i,children:"I forgot my password"})]})]})]})})})},j=e=>{var t,i,r;return(0,N.BX)(a.K,{spacing:"4",divider:(0,N.tZ)(n.c,{}),px:{base:"4",md:"10"},children:[(0,N.tZ)(s.X,{size:"sm",children:"Settings"}),(0,N.tZ)(C,{onSubmit:async t=>{console.log("Account form data:",t),await e.onAccountFormSubmit(t)},defaultValues:{firstName:null===(t=e.data.details)||void 0===t?void 0:t.firstName,lastName:null===(i=e.data.details)||void 0===i?void 0:i.lastName,avatarURL:null===(r=e.data.details)||void 0===r?void 0:r.avatarURL,username:e.data.username}}),(0,N.tZ)(U,{onSubmit:async t=>{console.log("Email form data:",t),await e.onEmailFormSubmit(t)},onRemove:async t=>{console.log("Remove email:",t),await e.onEmailRemove(t)},onResendVerification:async t=>{console.log("Resend email confirmation:",t),await e.onEmailConfirmationResend(t)},defaultValues:{emails:e.data.emails||[]}}),(0,N.tZ)(z,{onSubmit:async t=>{console.log("Password form data:",t),await e.onPasswordFormSubmit(t)},passwordResetPath:"/password_reset"})]})};var k=()=>{var e,t,i;const a=(0,r.lC)(),{toast:n}=(0,r.lR)();return(0,N.tZ)(j,{data:{username:null===(e=a.user)||void 0===e?void 0:e.username,details:null===(t=a.user)||void 0===t?void 0:t.details,emails:null===(i=a.user)||void 0===i?void 0:i.emails},onAccountFormSubmit:async e=>{try{await a.updateDetails(e),n({title:"Account updated",status:"success"})}catch(t){n({title:"Error",description:t.message,status:"error"})}},onEmailFormSubmit:async e=>{try{await a.addEmail(e.emailAddress),n({title:"Email added",status:"success"})}catch(t){n({title:"Error",description:t.message,status:"error"})}},onEmailRemove:async e=>{try{await a.removeEmail(e),n({title:"Email removed",status:"success"})}catch(t){n({title:"Error",description:t.message,status:"error"})}},onPasswordFormSubmit:async e=>{try{await a.updatePassword(e.password),n({title:"Password updated",status:"success"})}catch(t){n({title:"Error",description:t.message,status:"error"})}},onEmailConfirmationResend:async e=>{try{await a.emailConfirmationResend(e),n({title:"Verification email sent",status:"success"})}catch(t){n({title:"Error",description:t.message,status:"error"})}}})};const _={label:"Settings",icon:"FaUserCog",menu:{order:100,type:"user"},auth:{isRequired:!0},layout:{name:"jaen"}}},5524:function(e,t,i){i.d(t,{e:function(){return l}});var r=i(2658),a=i(613),n=i(6470),s=i(7147),o=i(4246),l=(0,n.G)((function(e,t){const{className:i,...n}=e,l=(0,r.v)();return(0,o.jsx)(s.m.div,{ref:t,className:(0,a.cx)("chakra-card__body",i),__css:l.body,...n})}))},2658:function(e,t,i){i.d(t,{Y:function(){return a},v:function(){return n}});var r=i(3313),[a,n]=(0,r.eC)("Card")},3330:function(e,t,i){i.d(t,{Z:function(){return c}});var r=i(2658),a=i(613),n=i(6470),s=i(3739),o=i(8742),l=i(7147),d=i(4246),c=(0,n.G)((function(e,t){const{className:i,children:n,direction:c="column",justify:u,align:m,...h}=(0,s.Lr)(e),f=(0,o.jC)("Card",e);return(0,d.jsx)(l.m.div,{ref:t,className:(0,a.cx)("chakra-card",i),__css:{display:"flex",flexDirection:c,justifyContent:u,alignItems:m,position:"relative",minWidth:0,wordWrap:"break-word",...f.container},...h,children:(0,d.jsx)(r.Y,{value:f,children:n})})}))},8671:function(e,t,i){i.d(t,{HC:function(){return p},QI:function(){return f},aV:function(){return h}});var r=i(3013),a=i(7493),n=i(1837),s=i(6470),o=i(8742),l=i(3739),d=i(7147),c=i(4246),[u,m]=(0,a.k)({name:"ListStylesContext",errorMessage:"useListStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<List />\" "}),h=(0,s.G)((function(e,t){const i=(0,o.jC)("List",e),{children:r,styleType:a="none",stylePosition:s,spacing:m,...h}=(0,l.Lr)(e),f=(0,n.W)(r),p=m?{"& > *:not(style) ~ *:not(style)":{mt:m}}:{};return(0,c.jsx)(u,{value:i,children:(0,c.jsx)(d.m.ul,{ref:t,listStyleType:a,listStylePosition:s,role:"list",__css:{...i.container,...p},...h,children:f})})}));h.displayName="List",(0,s.G)(((e,t)=>{const{as:i,...r}=e;return(0,c.jsx)(h,{ref:t,as:"ol",styleType:"decimal",marginStart:"1em",...r})})).displayName="OrderedList";var f=(0,s.G)((function(e,t){const{as:i,...r}=e;return(0,c.jsx)(h,{ref:t,as:"ul",styleType:"initial",marginStart:"1em",...r})}));f.displayName="UnorderedList";var p=(0,s.G)((function(e,t){const i=m();return(0,c.jsx)(d.m.li,{ref:t,...e,__css:i.item})}));p.displayName="ListItem",(0,s.G)((function(e,t){const i=m();return(0,c.jsx)(r.J,{ref:t,role:"presentation",...e,__css:i.icon})})).displayName="ListIcon"},7704:function(e,t,i){i.d(t,{c:function(){return n}});var r=i(7147),a=i(4246),n=e=>(0,a.jsx)(r.m.div,{className:"chakra-stack__divider",...e,__css:{...e.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});n.displayName="StackDivider"}}]);
//# sourceMappingURL=component---packages-gatsby-plugin-jaen-src-pages-settings-tsx-1c4df8405456d395ba58.js.map
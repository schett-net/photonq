"use strict";(self.webpackChunkphotonq=self.webpackChunkphotonq||[]).push([[391],{9605:function(e,t,n){n.r(t),n.d(t,{Head:function(){return I.Fb},default:function(){return K},pageConfig:function(){return M}});var r=n(2955),i=n(2605),o=n(3778),a=n(5699),s=n(3793),c=n(4771),u=n(3242),l=n(9981),d=n(3177),f=n(3863),h=n(948),p=n(9913),y=n(2298),m=n(7378),v=n(7228),g=n(4769);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}var b=0;function j(e){return"__private_"+b+++"_"+e}function x(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function P(e){const t={},n=new Proxy(e,{get(n,r,i){const o=Reflect.get(n,r,i);return!n.$isTracked||"string"==typeof r&&r.startsWith("$")?o:("string"!=typeof r||r in t||!e.hasOwnProperty(r)&&"function"!=typeof o||(t[r]={name:r,args:[]}),"function"==typeof o?function(){const e=arguments[0]||[],n=Object.entries(e).map((e=>{let[t,n]=e;return{name:t,value:n}})),i=o.apply(this,arguments);if("string"==typeof r){t[r].isFnAndCalled=!0;for(const e of n)t[r].args.find((t=>t.name===e.name))||t[r].args.push(e)}return i}:o)}});return Object.assign(n,{$trackedProps:t,$isTracked:!0})}function S(e){let t=null,n=P({});return new Proxy({},{get:(r,i,o)=>(t||(t=new e,n=P(t),t=n),Reflect.get(t,i,o)),getOwnPropertyDescriptor:(e,n)=>Object.getOwnPropertyDescriptor(t,n),ownKeys:()=>Reflect.ownKeys(t)})}function O(e){let t;return new Proxy([],{get(n,r,i){if(t||(t=P(new e)),!t||!t.$isTracked||"symbol"==typeof r||"length"===r)return Reflect.get(n,r,i);const o=Number(r);return isNaN(o)?Array.prototype.hasOwnProperty(r)?function(){var e,n;const i=r;for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];switch(i){case"concat":case"copyWithin":case"fill":case"pop":case"push":case"reverse":case"shift":case"sort":case"splice":case"unshift":case"filter":return(e=Array.prototype[i]).call.apply(e,[[t]].concat(a)),[t];case"entries":case"flatMap":case"forEach":case"keys":case"map":case"slice":case"values":case"every":case"find":case"findIndex":case"includes":case"indexOf":case"lastIndexOf":case"some":case"flat":case"reduce":case"reduceRight":return(n=Array.prototype[i]).call.apply(n,[[t]].concat(a));case"toLocaleString":case"toString":return Array.prototype[i].call([t]);default:throw new Error("Unsupported array prototype method: "+i.toString())}}:Reflect.get(n,r,i):t}})}const _=e=>{const t=O(e),n=()=>t;return n.isProxied=!0,n},T=async e=>{let t={headers:{}};for(const n of e){const e=await n({context:t});e&&(t=e)}return t},k=e=>!(!e||!("function"==typeof e&&e.isProxied||Array.isArray(e)&&e.length&&e[0].$isTracked||e.$isTracked));let A=function(){function e(e){this.type=void 0,this.name=void 0,this.fields=void 0,this.type=e.type,this.name=e.name,this.fields=[]}var t=e.prototype;return t.addField=function(e,t){if(void 0===t&&(t=""),e.args=e.args.filter((e=>{const t=typeof e.value;return("string"===t||"number"===t||"boolean"===t||"object"===t||"function"===t&&e.value.preventStringSerialization)&&null!=e.value})),t){const n=t.split(".");let r=this.fields;for(const e of n){const t=r.find((t=>t.name===e));t&&(t.fields=t.fields||[],r=t.fields)}r.push(e)}else this.fields.push(e)},t.toString=function(){const e=e=>{const n=e.args.map((e=>{const t="function"==typeof e.value&&e.value.preventStringSerialization?E(e.value(),!1):E(e.value);return e.name+": "+t})).join(", "),r=e.fields?" {__typename "+t(e.fields)+"}":"";return n?e.name+"("+n+")"+r:""+e.name+r},t=t=>t.map(e).join(" ");return this.type+" "+this.name+" {__typename "+t(this.fields)+"}"},e}();function E(e,t){if(void 0===t&&(t=!0),null==e)return"null";if("function"==typeof e&&e.preventStringSerialization)return E(e(),!1);if("object"!=typeof e)return t?JSON.stringify(e):String(e);if(Array.isArray(e)){const n=e.map((e=>E(e,t))).join(", ");return t?"["+n+"]":n}if("object"==typeof e)return"{"+Object.entries(e).map((e=>{let[n,r]=e;return n+": "+E(r,t)})).join(", ")+"}";throw new Error("Cannot stringify data of type "+typeof e)}let L=function(){function e(e,t){void 0===t&&(t={}),this.url=void 0,this.headers=void 0,this.url=e,this.headers=t}return e.prototype.execute=async function(e){const t=(e=>{const t=[];(e=>{let{node:t,onPath:n}=e;const r=function(e,t){void 0===t&&(t=[]);const i=Object.entries(e.$trackedProps||{});if(0===i.length){const r=Object.entries(e);for(const[e,i]of r){let r=i;Array.isArray(r)&&(r=r[0]),"function"==typeof r||k(r)||e.startsWith("$")||n(e,t.join("."),[])}}else for(const[o,a]of i){let i=e[o];if(("function"!=typeof i||a.isFnAndCalled)&&(a.isFnAndCalled&&(i=e[o]()),Array.isArray(i)&&(i=i[0]),n(o,t.join("."),a.args),k(i))){const e=[].concat((0,g.Z)(t),[o]);r(i,e)}}};r(t)})({node:e.node,onPath:(e,n,r)=>{t.push({name:e,path:n,args:r})}});const n=new A({type:e.type,name:e.name});for(const{name:r,path:i,args:o}of t)n.addField({name:r,args:o},i);return n})({type:e.type,name:e.name,node:e.node}).toString(),n=await fetch(this.url,{method:"POST",headers:w({"Content-Type":"application/json"},this.headers),body:JSON.stringify({query:t}),credentials:"include"});return await n.json()},e}();var N=j("type"),q=j("node"),R=j("context"),Z=j("apiURL"),C=j("attempt");let U=function(){function e(e){Object.defineProperty(this,N,{writable:!0,value:void 0}),this.name=void 0,Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,Z,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:0}),x(this,N)[N]=e.type,this.name=e.name,x(this,q)[q]=e.node,x(this,R)[R]=e.context,x(this,Z)[Z]=e.apiURL}var t=e.prototype;return t.getContext=function(){return x(this,R)[R]},t.setContext=function(e){x(this,R)[R]=e},t.getAttempt=function(){return x(this,C)[C]},t.execute=async function(){x(this,C)[C]++;const e=new L(x(this,Z)[Z],x(this,R)[R].headers),{data:t,errors:n}=await e.execute({type:x(this,N)[N],name:this.name,node:x(this,q)[q]}),r=t?(e=>{const{node:t,data:n}=e,r=(e,t)=>{const n={};if(!t)return null;for(const[i,o]of Object.entries(t)){const t=e[i];if(void 0===t)continue;const a="function"==typeof t;let s=t;if(a&&(s=t()),Array.isArray(s)&&o){const e=o.map(((e,t)=>s[t]?r(s[t],e):e));s=e}else if(null!==s&&"object"==typeof s){const e=r(s,o);s=e}else s=o;n[i]=a?()=>s:s}return n};return r(t,n)})({node:x(this,q)[q],data:t}):null;return{data:r,errors:n}},e}();const $=async(e,t)=>{var n;let r,i={data:null,errors:[]};try{i=await e.execute()}catch(e){r=e}if(t&&(null!=(n=i)&&n.errors||r)){var o;const n=null==t?void 0:t({forward:e=>$(e),operation:e,graphQLErrors:(null==(o=i)?void 0:o.errors)||[],networkError:r});if(n){const e=await n;if(e)return i=e,i}}if(r)throw r;return i};var B=j("makeKey");let F=function(e){Object.defineProperty(this,B,{value:Q}),this.get=void 0,this.set=void 0,this.remove=void 0,this.get=t=>e.get(x(this,B)[B](t)),this.set=(t,n)=>e.set(x(this,B)[B](t),n),this.remove=t=>e.remove(x(this,B)[B](t))};function Q(e){return F.KEY+":"+e}F.KEY="@snek-query:storage";new F({get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))});let X=function(){this.__typename="",this.id="",this.label=null,this.defaultPath=null,this.fqdn="",this.host="",this.port=null};const z=((e,t)=>{const n=async function(n,r,i){void 0===i&&(i={});const o=e[n];if(!o)throw new Error("No "+n+" operation defined.");const a=S(o),s=await T(t.middlewares||[]);s.headers=w({},s.headers,i.headers),r(a);const c=new Promise((async(e,o)=>{try{const o=new U({apiURL:t.apiURL,type:"Query"===n?"query":"mutation",name:i.name||"SnekQueryOperation",node:a,context:s}),c=await $(o,t.onError);e([r(c.data||a),c.errors])}catch(e){o(e)}}));return c},r=function(n,r){void 0===r&&(r="Unnamed");const i=e[n];if(!i)throw new Error("No "+n+" operation defined.");const o=S(i);return[async()=>{const e=await T(t.middlewares||[]),i=new U({apiURL:t.apiURL,type:"Query"===n?"query":"mutation",name:r,node:o,context:e}),a=await $(i,t.onError);return{data:a.data||o,errors:a.errors}},o]};return{query:async function(e,t){return void 0===t&&(t={}),n("Query",e,t)},mutate:async function(e,t){return void 0===t&&(t={}),n("Mutation",e,t)},lazyQuery:()=>r("Query"),lazyMutation:()=>r("Mutation")}})({Query:function(){this.__typename="",this.allService=O(X),this.version=""},Mutation:function(){this.__typename="",this.serviceLableUpdate=_(X),this.serviceDefaultPathUpdate=_(X)}},{apiURL:"https://photonq.lens.atsnek.com/graphql"});var G=n(7800),I=n(4482);var K=()=>{const{0:e,1:t}=(0,m.useState)(!0),{0:n,1:g}=(0,m.useState)([]);(0,m.useEffect)((()=>{(async()=>{t(!0);const[e,n]=await z.query((e=>e.allService));var r;if(n)throw new Error(null===(r=n[0])||void 0===r?void 0:r.message);g(e),t(!1)})()}),[]);const{0:w,1:b}=(0,m.useState)(!1);return(0,G.BX)(r.K,{spacing:"4",children:[(0,G.BX)(i.X,{size:"md",children:["Services (",n.length,")"]}),(0,G.tZ)(o.U,{justifyContent:"end",children:(0,G.tZ)(a.z,{variant:"outline",leftIcon:(0,G.tZ)(v.FaEdit,{}),onClick:()=>{b(!w)},children:w?"Done":"Edit"})}),(0,G.BX)(s.i,{children:[(0,G.tZ)(c.h,{children:(0,G.BX)(u.Tr,{children:[(0,G.tZ)(l.Th,{children:"Service"}),(0,G.tZ)(l.Th,{children:"Host"}),(0,G.tZ)(l.Th,{children:"Port"})]})}),(0,G.BX)(d.p,{children:[e&&(0,G.tZ)(u.Tr,{children:(0,G.tZ)(f.Td,{colSpan:4,children:"Loading..."})}),n.map((e=>(0,G.BX)(u.Tr,{children:[(0,G.tZ)(f.Td,{children:w?(0,G.tZ)(h.I,{defaultValue:e.label||e.id,onBlur:t=>{(async(e,t)=>{const[n,r]=await z.mutate((n=>n.serviceLableUpdate({id:e,label:t})));var i;if(r)throw new Error(null===(i=r[0])||void 0===i?void 0:i.message);g(n)})(e.id,t.target.value)}}):(0,G.tZ)(p.r,{as:y.rU,to:"/lens/service/#"+e.fqdn+(e.defaultPath||""),children:e.label||e.id})}),(0,G.tZ)(f.Td,{children:e.host}),(0,G.tZ)(f.Td,{children:e.port})]},e.id)))]})]})]})};const M={label:"Lens",icon:"FaBullseye",menu:{type:"app",order:500},layout:{name:"jaen"},auth:{isRequired:!0,isAdminRequired:!0},breadcrumbs:[{label:"Lens",path:"/lens/"}]}},2605:function(e,t,n){n.d(t,{X:function(){return u}});var r=n(6470),i=n(8742),o=n(3739),a=n(7147),s=n(613),c=n(4246),u=(0,r.G)((function(e,t){const n=(0,i.mq)("Heading",e),{className:r,...u}=(0,o.Lr)(e);return(0,c.jsx)(a.m.h2,{ref:t,className:(0,s.cx)("chakra-heading",e.className),...u,__css:n})}));u.displayName="Heading"},4771:function(e,t,n){n.d(t,{h:function(){return s}});var r=n(3793),i=n(6470),o=n(7147),a=n(4246),s=(0,i.G)(((e,t)=>{const n=(0,r.p)();return(0,a.jsx)(o.m.thead,{...e,ref:t,__css:n.thead})}))},3793:function(e,t,n){n.d(t,{i:function(){return f},p:function(){return d}});var r=n(6470),i=n(8742),o=n(3739),a=n(7147),s=n(613),c=n(7493),u=n(4246),[l,d]=(0,c.k)({name:"TableStylesContext",errorMessage:"useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Table />\" "}),f=(0,r.G)(((e,t)=>{const n=(0,i.jC)("Table",e),{className:r,layout:c,...d}=(0,o.Lr)(e);return(0,u.jsx)(l,{value:n,children:(0,u.jsx)(a.m.table,{ref:t,__css:{tableLayout:c,...n.table},className:(0,s.cx)("chakra-table",r),...d})})}));f.displayName="Table"},3242:function(e,t,n){n.d(t,{Tr:function(){return s}});var r=n(3793),i=n(6470),o=n(7147),a=n(4246),s=(0,i.G)(((e,t)=>{const n=(0,r.p)();return(0,a.jsx)(o.m.tr,{...e,ref:t,__css:n.tr})}))},3177:function(e,t,n){n.d(t,{p:function(){return s}});var r=n(3793),i=n(6470),o=n(7147),a=n(4246),s=(0,i.G)(((e,t)=>{const n=(0,r.p)();return(0,a.jsx)(o.m.tbody,{...e,ref:t,__css:n.tbody})}))},9981:function(e,t,n){n.d(t,{Th:function(){return s}});var r=n(3793),i=n(6470),o=n(7147),a=n(4246),s=(0,i.G)((({isNumeric:e,...t},n)=>{const i=(0,r.p)();return(0,a.jsx)(o.m.th,{...t,ref:n,__css:i.th,"data-is-numeric":e})}))},3863:function(e,t,n){n.d(t,{Td:function(){return s}});var r=n(3793),i=n(6470),o=n(7147),a=n(4246),s=(0,i.G)((({isNumeric:e,...t},n)=>{const i=(0,r.p)();return(0,a.jsx)(o.m.td,{...t,ref:n,__css:i.td,"data-is-numeric":e})}))}}]);
//# sourceMappingURL=component---packages-gatsby-jaen-lens-src-pages-lens-index-tsx-0aaceab5ae465fb0f1c7.js.map